<!-- The View for the Flight Price search results table. -->


<!-- The ViewModel for this view is the HomePageQuotesViewModel -->
@model FlightPrices.WebApp.ViewModels.Home.HomePageQuotesViewModel

@{
    ViewData["Title"] = "Flights";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!--Display some title information-->
    <div class="form-group">
        <h3>
            Here's what we found for:
        </h3>
        <h6 style="font-weight:normal">
            @Model.OriginAirport &rArr; @Model.DestinationAirport
        </h6>
        <h6 style="font-weight:normal">
            <span style="font-weight:bold">Departing on:</span> @Model.DepartureDate.ToString(" dddd MMMM dd, yyyy")
        </h6>
        @if (Model.IsRoundTrip)
        {
            <h6 style="font-weight:normal">
                <span style="font-weight:bold">Returning on:</span> @Model.ReturnDate.ToString(" dddd MMMM dd, yyyy")
            </h6>
        }
    </div>


<!-- This table holds the quote data -->
<table id="flights"
       class="table table-striped table-bordered"
       style="width:100%">
    <thead>                                           <!-- Headers for the table -->                         
        <tr>
            <th>Departure Airline</th>                <!-- Departure Airline Column -->
            <th>Departure Time (EST)</th>             <!-- Departure takeoff time column -->
            <th>Departure Arrival Time (EST)</th>     <!-- Departure arrival time column -->
            <th>Departure Trip # Stops</th>           <!-- Departure arrival time column -->
                            
            <!-- Only display these columns if a round trip search -->
            @if (Model.IsRoundTrip)                   
            {
                <th>Return Airline</th>               <!-- Return Airline Column -->
                <th>Return Time (EST)</th>            <!-- Return takeoff time column -->
                <th>Return Arrival Time (EST) </th>   <!--Return trip arrvial time-->
                <th># Return Stops</th>               <!--Return trip stop count-->
            }

            <th>Price ($)</th>                         <!-- Price Column Header; assumes value in USA dollars -->
        </tr>
    </thead>

    <!-- This is the actual body of the table -->  
    <tbody>
                                                               <!-- For each quote, create a row -->
        @foreach (var quote in Model.Quotes)
        {
            <tr>
                <td>@quote.DepartureAirline</td>               <!-- Display departure airline name -->

                <!-- Display the departure takeoff time -->
                <td data-order="@quote.DepartureTakeoffTime.TimeOfDay">@quote.DepartureTakeoffTime.ToString("hh:mm tt")</td>  

                <td data-order="@quote.DepartureArrivalTime.TimeOfDay">@quote.DepartureArrivalTime.ToString("hh:mm tt")</td> 
                
                <td>@quote.DepartureStopCount</td>              <!--Display the number of stops on the departure trip-->

                <!-- Only display if a round trip search -->                                       
                @if (Model.IsRoundTrip)
                {
                    <td>@quote.ReturnAirline</td>              <!-- Display Return Airline name -->

                    <!-- Display the return takeoff time -->
                    <td data-order="@quote.ReturnTakeoffTime.Value.TimeOfDay">@quote.ReturnTakeoffTime.Value.ToString("hh:mm tt")</td>  

                    <!-- Display the return takeoff time -->
                    <td data-order="@quote.ReturnArrivalTime.Value.TimeOfDay">@quote.ReturnArrivalTime.Value.ToString("hh:mm tt")</td>  

                    <td>@quote.ReturnStopCount</td>
                }

                <td>@Decimal.ToInt32(quote.Cost.Value)</td>    <!-- No cents - display as int -->
            </tr>

        }
    </tbody>
</table>

@section scripts
{
    <script>

        // This JQuery function builds and configures the datatable
        $(document).ready(function() 
        {
            // 'flights' is the id of the datatable div element 
            $('#flights').DataTable(
            {
                "bInfo": false,            // Disable displaying data about the current datatable 
                "pageLength": 5,           // Set the number of rows per page to 5
                "bLengthChange": false     // Turn of the menu item for setting the number of rows per page
            });
        });
    </script>
}